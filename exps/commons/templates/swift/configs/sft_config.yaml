# SFT 训练配置。路径等元信息使用占位符，与 verl 模板一致（__EXP_NAME__ 自动替换，其余需在实验目录中替换）。

# 按实验修改：base 模型路径
model: "__MODELS_ROOT__/Qwen3-4B-Instruct-2507"
loss_scale: "default"
model_type: "qwen3"
template: "qwen3_nothinking"
train_type: "full"

# 按实验修改：数据路径与长度
dataset:
  - "__WORK_ROOT__/data/hardgen/hardgen_openai_messages_fc.json#1000"
max_length: 10240
split_dataset_ratio: 0.05

attn_impl: "flash_attention_2"
gradient_checkpointing: true
packing: true

torch_dtype: "bfloat16"
dataloader_num_workers: 8

num_train_epochs: 1
per_device_train_batch_size: 1
per_device_eval_batch_size: 1
learning_rate: 1e-5
warmup_ratio: 0.05
lr_scheduler_type: "cosine"
gradient_accumulation_steps: 16
max_grad_norm: 1.0
weight_decay: 0.01

eval_steps: 10
save_steps: 10
save_total_limit: 2
logging_steps: 10
eval_strategy: "steps"
save_strategy: "steps"
eval_on_start: true
# 按实验修改：checkpoint 输出目录
output_dir: "__WORK_ROOT__/checkpoints/__EXP_NAME__"
seed: 42

report_to: "swanlab"
swanlab_project: "hardtry"
swanlab_exp_name: "__EXP_NAME__"

fsdp: "fsdp2"
